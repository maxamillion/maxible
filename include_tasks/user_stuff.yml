---
# Meant to be used with import_tasks
#
- name: pip user install some stuff
  shell: "python -mpip install --user {{item}}"
  loop:
    - ptpython
    - virtualenvwrapper
    - tox
    - httpie
    - flake8
    - pep8
    - pyflakes
    - pylint
    - black
    - q
    - pipenv
    - poetry
    - tmuxp
    - bpytop
    - python-lsp-server
  args:
    creates: ~/.local/bin/{{item}}

- name: pip user install virtualenvwrapper (it's special)
  shell: python -mpip install --user virtualenvwrapper
  args:
    creates: ~/.local/bin/virtualenvwrapper.sh

- name: pip user install q (it's special)
  shell: python -mpip install --user q
  args:
    creates: ~/.local/lib/python{{ansible_python["version"]["major"]}}.{{ansible_python["version"]["minor"]}}/site-packages/q.py
  tags:
    - pipq

- name: check for local poetry bash completions
  stat:
    path: ~/.local/poetry.bash-completion
  register: poetry_stat

- name: generate local poetry bash completions if they aren't present
  shell: ~/.local/bin/poetry completions bash > ~/.local/poetry.bash-completion
  when: not poetry_stat.stat.exists

